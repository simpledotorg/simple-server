{
  "swagger": "2.0",
  "basePath": "/api/v3",
  "produces": [
    "application/json"
  ],
  "consumes": [
    "application/json"
  ],
  "schemes": [
    "https"
  ],
  "info": {
    "description": "# API spec for Simple Server\n## Sync APIs\nThis API spec documents the endpoints that the devices (that are offline to varying levels) will use to sync data. The sync end points will send and receive bulk (a list of) entities. Both sending and receiving can be batched with configurable batch-sizes to accommodate low network bandwidth situations.\n\n## Nesting resources\nThe APIs have been designed to provide an optimal balance between accuracy and simplicity. Some of the APIs (patients) will be nested, and some other (blood pressures) will be flat.\n\n## Sync Mechanism\nRefer to the [related ADR](https://github.com/simpledotorg/simple-server/blob/master/doc/arch/001-synchronization.md).\n\n## API Authentication\nThere are two types of authentication available to access different parts of the Simple API.\n- User Authentication - For medical professionals using the Simple App. Grants access to most of the Simple API\n  to read and write data for communities of patients.\n- Patient authentication - For individual patients. Grants access to read a patient's own data.\n\n### User Authentication\n\nA Simple client can make authenticated requests to the Simple API on behalf of a medical professional with the\nfollowing three required credentials:\n- API Access Token\n- User ID\n- Facility ID\n\nIn order to obtain these credentials, a Simple client can authenticate a user with the following steps. The\nclient will need the user's registered phone number to perform the authentication.\n1. Submit the users phone number to the [`POST /v4/users/find` endpoint](#tag/User/paths/~1users~1find/post). If\na user exists with this phone number, the response will return their id.\n2. Submit the user's id retreived in the previous step, along with the user's password to the\n[`POST v4/users/activate` endpoint](#tag/User/paths/~1users~1activate/post).\nThis will validate the user's password, and trigger an OTP to be sent to the user's phone number.\n3. Submit the user's id, their password, and the OTP (received after the previous step) to the\n[`POST v3/login` endpoint](#tag/User-Login/paths/~1login/post). If the submitted otp and password are valid,\nthis will return an access token that can be used to authenticate the user. The access token will remain valid\nuntil the user signs into another device.\n\nOn successful authentication, the client will receive a payload containing an API access token and some user\ninformation.\nThe following headers need to be attached to subsequent requests as shown below.\n- `Authorization: Bearer <access token>`\n- `X-User-Id: <user ID>`\n- `X-Facility-Id: <facility ID>` This is the id for either the registration facility of the user, or another\nfacility in their facility group.\n\n### Patient Authentication\nA Simple client can make authenticated requests to the Simple API on behalf of a patient with the following\ncredentials:\n- API Access Token\n- Patient ID\n\nIn order to obtain these credentials, a Simple client can authenticate a patient with the following steps. The\nclient will need the patient's BP Passport UUID to perform the authentication.\n1. Submit the patient's BP Passport UUID to the [`POST /v4/patients/activate` endpoint](#tag/Patient/paths/~1patient~1activate/post).\n   This will trigger an OTP message to be sent to the patient's registered phone number.\n2. Submit the patient's BP Passport UUID and OTP (received after the previous step) to the [`POST /v4/patients/login` endpoint](#tag/Patient/paths/~1patient~1login/post)\n\nOn successful authentication, the client will receive a payload containing an API access token and a patient ID.\nBoth of these data points need to be attached to subsequent requests as request headers as shown below.\n- `Authorization: Bearer <access token>`\n- `X-Patient-Id: <patient ID>`\n\nThe API access token will remain valid until the patient signs into another device.\n\nThe comprehensive list of authentication mechanisms used is provided below. It lists the specific details of\nusing access tokens and other request headers to authenticate with the API.\n",
    "version": "v3",
    "title": "Simple Server",
    "x-logo": {
      "url": "/assets/rtsl_logo-90ad9b477469fd15ef3b36063601e9857417cb3e336d8408226260297fa4fed9.png",
      "backgroundColor": "#FFFFFF"
    },
    "contact": {
      "email": "eng-backend@resolvetosavelives.org"
    },
    "license": {
      "name": "MIT",
      "url": "https://github.com/simpledotorg/simple-server/blob/master/LICENSE"
    }
  },
  "paths": {
    "/analytics/user_analytics": {
      "get": {
        "summary": "Sends JSON containing analytics for User",
        "tags": [
          "analytics"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          }
        ],
        "responses": {
          "200": {
            "description": "JSON received"
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/analytics/user_analytics.html": {
      "get": {
        "summary": "Sends a static HTML containing analytics for user",
        "tags": [
          "analytics"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "produces": [
          "text/html"
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          }
        ],
        "responses": {
          "200": {
            "description": "HTML received"
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/appointments/sync": {
      "post": {
        "summary": "Syncs appointment data from device to server.",
        "tags": [
          "Appointments"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "appointments",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "appointments": {
                  "$ref": "#/definitions/appointments"
                }
              },
              "required": [
                "appointments"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "some, or no errors were found"
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      },
      "get": {
        "summary": "Syncs appointment data from server to device.",
        "tags": [
          "Appointments"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "appointments received",
            "schema": {
              "type": "object",
              "properties": {
                "appointments": {
                  "$ref": "#/definitions/appointments"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "appointments",
                "process_token"
              ]
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/blood_pressures/sync": {
      "post": {
        "summary": "Syncs blood pressure data from device to server.",
        "tags": [
          "Blood Pressure"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "blood_pressures",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "blood_pressures": {
                  "$ref": "#/definitions/blood_pressures"
                }
              },
              "required": [
                "blood_pressures"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "some, or no errors were found",
            "schema": {
              "type": "object",
              "properties": {
                "errors": {
                  "$ref": "#/definitions/errors"
                }
              }
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      },
      "get": {
        "summary": "Syncs blood pressure data from server to device.",
        "tags": [
          "Blood Pressure"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "blood pressures received",
            "schema": {
              "type": "object",
              "properties": {
                "blood_pressures": {
                  "$ref": "#/definitions/blood_pressures"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "blood_pressures",
                "process_token"
              ]
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/blood_sugars/sync": {
      "post": {
        "summary": "Syncs blood sugar data from device to server.",
        "tags": [
          "Blood Sugar"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "blood_sugars",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "blood_sugars": {
                  "$ref": "#/definitions/blood_sugars"
                }
              },
              "required": [
                "blood_sugars"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "some, or no errors were found",
            "schema": {
              "type": "object",
              "properties": {
                "errors": {
                  "$ref": "#/definitions/errors"
                }
              }
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      },
      "get": {
        "summary": "Syncs blood sugar data from server to device.",
        "tags": [
          "Blood Sugar"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "blood sugar received",
            "schema": {
              "type": "object",
              "properties": {
                "blood_sugars": {
                  "$ref": "#/definitions/blood_sugars"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "blood_sugars",
                "process_token"
              ]
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/encounters/sync": {
      "post": {
        "summary": "Syncs encounters data from device to server.",
        "tags": [
          "Encounters"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "encounters",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "encounters": {
                  "$ref": "#/definitions/encounters"
                }
              },
              "required": [
                "encounters"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "some, or no errors were found",
            "schema": {
              "type": "object",
              "properties": {
                "errors": {
                  "$ref": "#/definitions/errors"
                }
              }
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      },
      "get": {
        "summary": "Syncs encounters data from server to device.",
        "tags": [
          "Encounters"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "encounters received",
            "schema": {
              "type": "object",
              "properties": {
                "encounters": {
                  "$ref": "#/definitions/encounters"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "encounters",
                "process_token"
              ]
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/facilities/sync": {
      "get": {
        "summary": "Syncs facilities data from server to device.",
        "tags": [
          "facility"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "facilities received",
            "schema": {
              "type": "object",
              "properties": {
                "facilities": {
                  "$ref": "#/definitions/facilities"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "facilities",
                "process_token"
              ]
            }
          }
        }
      }
    },
    "/help.html": {
      "get": {
        "summary": "Sends a static HTML containing help documentation",
        "tags": [
          "help"
        ],
        "produces": [
          "text/html"
        ],
        "responses": {
          "200": {
            "description": "HTML received"
          }
        }
      }
    },
    "/login": {
      "post": {
        "summary": "Login in valid user",
        "tags": [
          "User Login"
        ],
        "parameters": [
          {
            "name": "user",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "user": {
                  "$ref": "#/definitions/login_user"
                }
              },
              "required": [
                "user"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "user is logged in",
            "schema": {
              "type": "object",
              "properties": {
                "access_token": {
                  "$ref": "#/definitions/non_empty_string"
                },
                "user": {
                  "$ref": "#/definitions/user"
                }
              },
              "required": [
                "user",
                "access_token"
              ]
            }
          },
          "401": {
            "description": "user is not logged in with otp",
            "schema": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string",
                  "format": "uuid",
                  "description": "Id of the record with errors"
                },
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "List of json schema error strings describing validation errors"
                },
                "field_with_error": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/medical_histories/sync": {
      "post": {
        "summary": "Syncs medical_history data from device to server.",
        "tags": [
          "Medical History"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "medical_histories",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "medical_histories": {
                  "$ref": "#/definitions/medical_histories"
                }
              },
              "required": [
                "medical_histories"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "some, or no errors were found",
            "schema": {
              "type": "object",
              "properties": {
                "errors": {
                  "$ref": "#/definitions/errors"
                }
              }
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      },
      "get": {
        "summary": "Syncs medical_history data from server to device.",
        "tags": [
          "Medical History"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "medical_histories received",
            "schema": {
              "type": "object",
              "properties": {
                "medical_histories": {
                  "$ref": "#/definitions/medical_histories"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "medical_histories",
                "process_token"
              ]
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/patients/sync": {
      "post": {
        "summary": "Syncs patient, address and phone number data from device to server.",
        "tags": [
          "patient"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "patients",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "patients": {
                  "$ref": "#/definitions/nested_patients"
                }
              },
              "required": [
                "patients"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "some, or no errors were found",
            "schema": {
              "type": "object",
              "properties": {
                "errors": {
                  "$ref": "#/definitions/errors"
                }
              }
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      },
      "get": {
        "summary": "Syncs patient, address and phone number data from server to device.",
        "tags": [
          "patient"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "patients received",
            "schema": {
              "type": "object",
              "properties": {
                "patients": {
                  "$ref": "#/definitions/nested_patients"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "patients",
                "process_token"
              ]
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/prescription_drugs/sync": {
      "post": {
        "summary": "Syncs prescription drugs data from device to server.",
        "tags": [
          "Prescription Drug"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "prescription_drugs",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "prescription_drugs": {
                  "$ref": "#/definitions/prescription_drugs"
                }
              },
              "required": [
                "prescription_drugs"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "some, or no errors were found",
            "schema": {
              "type": "object",
              "properties": {
                "errors": {
                  "$ref": "#/definitions/errors"
                }
              }
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      },
      "get": {
        "summary": "Syncs prescription drugs data from server to device.",
        "tags": [
          "Prescription Drug"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "HTTP_X_USER_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "HTTP_X_FACILITY_ID",
            "in": "header",
            "type": "uuid"
          },
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "prescription drugs received",
            "schema": {
              "type": "object",
              "properties": {
                "prescription_drugs": {
                  "$ref": "#/definitions/prescription_drugs"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "prescription_drugs",
                "process_token"
              ]
            }
          },
          "403": {
            "description": "user is not allowed to sync"
          }
        }
      }
    },
    "/protocols/sync": {
      "get": {
        "summary": "Syncs protocols and protocol drugs data from server to device.",
        "tags": [
          "protocol"
        ],
        "parameters": [
          {
            "name": "process_token",
            "type": "string",
            "format": "byte",
            "description": "Token containing all the information needed to process batch requests from the user",
            "in": "query"
          },
          {
            "in": "query",
            "name": "limit",
            "type": "integer",
            "description": "Number of record to retrieve (a.k.a batch-size)"
          }
        ],
        "responses": {
          "200": {
            "description": "protocols received",
            "schema": {
              "type": "object",
              "properties": {
                "protocols": {
                  "$ref": "#/definitions/protocols"
                },
                "process_token": {
                  "$ref": "#/definitions/process_token"
                }
              },
              "required": [
                "protocols",
                "process_token"
              ]
            }
          }
        }
      }
    },
    "/users/find": {
      "get": {
        "summary": "Find a existing user",
        "tags": [
          "User"
        ],
        "parameters": [
          {
            "name": "phone_number",
            "in": "query",
            "type": "string"
          },
          {
            "name": "id",
            "in": "query",
            "type": "string",
            "description": "User UUID"
          }
        ],
        "responses": {
          "200": {
            "description": "user is found",
            "schema": {
              "$ref": "#/definitions/user"
            }
          },
          "404": {
            "description": "user is not found"
          }
        }
      }
    },
    "/users/register": {
      "post": {
        "summary": "Register a new user",
        "tags": [
          "User"
        ],
        "parameters": [
          {
            "name": "user",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "user": {
                  "$ref": "#/definitions/user"
                }
              },
              "required": [
                "user"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "user is registered",
            "schema": {
              "type": "object",
              "properties": {
                "access_token": {
                  "$ref": "#/definitions/non_empty_string"
                },
                "user": {
                  "$ref": "#/definitions/user"
                }
              },
              "required": [
                "user",
                "access_token"
              ]
            }
          },
          "400": {
            "description": "returns bad request if phone number already exists"
          },
          "404": {
            "description": "returns not found if  facility id is not known"
          }
        }
      }
    },
    "/users/{id}/request_otp": {
      "post": {
        "summary": "Request OTP for login",
        "tags": [
          "User"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User UUID",
            "type": "string",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "user otp is reset and new otp is sent as an sms"
          },
          "404": {
            "description": "user is not found"
          }
        }
      }
    },
    "/users/me/reset_password": {
      "parameters": [
        {
          "name": "HTTP_X_USER_ID",
          "in": "header",
          "type": "uuid"
        },
        {
          "name": "HTTP_X_FACILITY_ID",
          "in": "header",
          "type": "uuid"
        }
      ],
      "post": {
        "summary": "Request for reset password",
        "tags": [
          "User"
        ],
        "security": [
          {
            "access_token": [

            ],
            "user_id": [

            ],
            "facility_id": [

            ]
          }
        ],
        "parameters": [
          {
            "name": "password_digest",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "password_digest": {
                  "$ref": "#/definitions/bcrypt_password"
                }
              },
              "required": [
                "password_digest"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "user password reset request is received",
            "schema": {
              "type": "object",
              "properties": {
                "access_token": {
                  "$ref": "#/definitions/non_empty_string"
                },
                "user": {
                  "$ref": "#/definitions/user"
                }
              },
              "required": [
                "user",
                "access_token"
              ]
            }
          },
          "401": {
            "description": "authentication failed"
          }
        }
      }
    }
  },
  "definitions": {
    "error": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Id of the record with errors"
        },
        "schema": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of json schema error strings describing validation errors"
        },
        "field_with_error": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "errors": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/error"
      }
    },
    "process_token": {
      "name": "process_token",
      "type": "string",
      "format": "byte",
      "description": "Token containing all the information needed to process batch requests from the user"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp with millisecond precision."
    },
    "uuid": {
      "type": "string",
      "format": "uuid",
      "pattern": "[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}"
    },
    "nullable_uuid": {
      "type": [
        "string",
        "null"
      ],
      "format": "uuid",
      "pattern": "[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}"
    },
    "non_empty_string": {
      "type": "string",
      "minLength": 1,
      "description": "This string should not be empty."
    },
    "nullable_timestamp": {
      "type": [
        "string",
        "null"
      ],
      "format": "date-time",
      "description": "Timestamp with millisecond precision."
    },
    "bcrypt_password": {
      "type": "string",
      "pattern": "^\\$[0-9a-z]{2}\\$[0-9]{2}\\$[A-Za-z0-9\\.\\/]{53}$",
      "description": "Bcrypt password digest"
    },
    "patient": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "gender": {
          "type": "string",
          "enum": [
            "male",
            "female",
            "transgender"
          ]
        },
        "full_name": {
          "$ref": "#/definitions/non_empty_string"
        },
        "status": {
          "type": "string",
          "enum": [
            "active",
            "dead",
            "migrated",
            "unresponsive",
            "inactive"
          ]
        },
        "date_of_birth": {
          "type": [
            "string",
            "null"
          ],
          "format": "date"
        },
        "age": {
          "type": [
            "integer",
            "null"
          ],
          "description": "When age is present, age_updated_at must be present as well."
        },
        "age_updated_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "recorded_at": {
          "$ref": "#/definitions/timestamp"
        },
        "registration_facility_id": {
          "$ref": "#/definitions/nullable_uuid"
        },
        "assigned_facility_id": {
          "$ref": "#/definitions/nullable_uuid"
        },
        "reminder_consent": {
          "type": "string",
          "enum": [
            "granted",
            "denied"
          ]
        },
        "deleted_reason": {
          "type": [
            "null",
            "string"
          ],
          "enum": [
            "duplicate",
            "unknown",
            "accidental_registration",
            null
          ]
        }
      },
      "required": [
        "id",
        "gender",
        "full_name",
        "created_at",
        "updated_at",
        "status"
      ]
    },
    "address": {
      "type": [
        "null",
        "object"
      ],
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "street_address": {
          "type": [
            "string",
            "null"
          ]
        },
        "village_or_colony": {
          "type": [
            "string",
            "null"
          ]
        },
        "zone": {
          "type": [
            "string",
            "null"
          ]
        },
        "district": {
          "type": [
            "string",
            "null"
          ]
        },
        "state": {
          "type": [
            "string",
            "null"
          ]
        },
        "country": {
          "type": [
            "string",
            "null"
          ]
        },
        "pin": {
          "type": [
            "string",
            "null"
          ]
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        }
      },
      "required": [
        "id",
        "created_at",
        "updated_at"
      ]
    },
    "phone_number": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "number": {
          "$ref": "#/definitions/non_empty_string"
        },
        "phone_type": {
          "type": "string",
          "enum": [
            "mobile",
            "landline"
          ]
        },
        "active": {
          "type": "boolean"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        }
      },
      "required": [
        "id",
        "created_at",
        "updated_at",
        "number"
      ]
    },
    "phone_numbers": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/phone_number"
      }
    },
    "nested_patient": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "gender": {
          "type": "string",
          "enum": [
            "male",
            "female",
            "transgender"
          ]
        },
        "full_name": {
          "$ref": "#/definitions/non_empty_string"
        },
        "status": {
          "type": "string",
          "enum": [
            "active",
            "dead",
            "migrated",
            "unresponsive",
            "inactive"
          ]
        },
        "date_of_birth": {
          "type": [
            "string",
            "null"
          ],
          "format": "date"
        },
        "age": {
          "type": [
            "integer",
            "null"
          ],
          "description": "When age is present, age_updated_at must be present as well."
        },
        "age_updated_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "recorded_at": {
          "$ref": "#/definitions/timestamp"
        },
        "registration_facility_id": {
          "$ref": "#/definitions/nullable_uuid"
        },
        "assigned_facility_id": {
          "$ref": "#/definitions/nullable_uuid"
        },
        "reminder_consent": {
          "type": "string",
          "enum": [
            "granted",
            "denied"
          ]
        },
        "deleted_reason": {
          "type": [
            "null",
            "string"
          ],
          "enum": [
            "duplicate",
            "unknown",
            "accidental_registration",
            null
          ]
        },
        "address": {
          "$ref": "#/definitions/address"
        },
        "phone_numbers": {
          "$ref": "#/definitions/phone_numbers"
        },
        "business_identifiers": {
          "$ref": "#/definitions/patient_business_identifiers"
        }
      },
      "required": [
        "id",
        "gender",
        "full_name",
        "created_at",
        "updated_at",
        "status"
      ],
      "description": "Patient with address, phone numbers and business identifiers nested."
    },
    "nested_patients": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/nested_patient"
      }
    },
    "encounter": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "pattern": "[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}",
          "description": "This uuid is generated by hashing (SHA-1) the facility id, patient id, and encountered_on fields"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "patient_id": {
          "$ref": "#/definitions/uuid"
        },
        "encountered_on": {
          "type": "string",
          "format": "date"
        },
        "notes": {
          "type": "string"
        },
        "observations": {
          "type": "object",
          "properties": {
            "blood_pressures": {
              "$ref": "#/definitions/blood_pressures"
            }
          },
          "required": [
            "blood_pressures"
          ]
        }
      },
      "required": [
        "id",
        "created_at",
        "updated_at",
        "patient_id",
        "encountered_on",
        "observations"
      ],
      "description": "Encounter with observations: blood_pressures"
    },
    "encounters": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/encounter"
      }
    },
    "blood_pressure": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "systolic": {
          "type": "integer"
        },
        "diastolic": {
          "type": "integer"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "recorded_at": {
          "$ref": "#/definitions/timestamp"
        },
        "patient_id": {
          "$ref": "#/definitions/uuid"
        },
        "facility_id": {
          "$ref": "#/definitions/uuid"
        },
        "user_id": {
          "$ref": "#/definitions/uuid"
        }
      },
      "required": [
        "systolic",
        "diastolic",
        "created_at",
        "updated_at",
        "patient_id",
        "facility_id",
        "user_id"
      ]
    },
    "blood_pressures": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/blood_pressure"
      }
    },
    "facility": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "name": {
          "$ref": "#/definitions/non_empty_string"
        },
        "street_address": {
          "type": "string"
        },
        "village_or_colony": {
          "type": "string"
        },
        "district": {
          "$ref": "#/definitions/non_empty_string"
        },
        "zone": {
          "type": [
            "string",
            "null"
          ]
        },
        "state": {
          "$ref": "#/definitions/non_empty_string"
        },
        "country": {
          "$ref": "#/definitions/non_empty_string"
        },
        "pin": {
          "type": "string"
        },
        "facility_type": {
          "type": "string"
        },
        "facility_group_id": {
          "$ref": "#/definitions/uuid"
        },
        "sync_region_id": {
          "type": [
            "string",
            "null"
          ]
        },
        "protocol_id": {
          "$ref": "#/definitions/uuid"
        },
        "config": {
          "type": "object",
          "properties": {
            "enable_diabetes_management": {
              "type": "boolean"
            },
            "enable_teleconsultation": {
              "type": "boolean"
            }
          }
        },
        "required": [
          "enable_diabetes_management",
          "enable_teleconsultation"
        ]
      },
      "required": [
        "id",
        "name",
        "district",
        "state",
        "country",
        "facility_group_id",
        "protocol_id"
      ]
    },
    "facilities": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/facility"
      }
    },
    "protocol_drug": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "protocol_id": {
          "$ref": "#/definitions/uuid"
        },
        "rxnorm_code": {
          "type": "string"
        },
        "dosage": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      },
      "required": [
        "id",
        "dosage",
        "name",
        "protocol_id"
      ]
    },
    "protocol_drugs": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/protocol_drug"
      }
    },
    "protocol": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "name": {
          "type": "string"
        },
        "follow_up_days": {
          "type": "integer"
        },
        "protocol_drugs": {
          "$ref": "#/definitions/protocol_drugs"
        }
      },
      "required": [
        "id",
        "name",
        "protocol_drugs"
      ]
    },
    "protocols": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/protocol"
      }
    },
    "prescription_drug": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "name": {
          "$ref": "#/definitions/non_empty_string"
        },
        "dosage": {
          "type": "string"
        },
        "rxnorm_code": {
          "type": "string"
        },
        "is_protocol_drug": {
          "type": "boolean"
        },
        "is_deleted": {
          "type": "boolean"
        },
        "patient_id": {
          "$ref": "#/definitions/uuid"
        },
        "facility_id": {
          "$ref": "#/definitions/uuid"
        },
        "frequency": {
          "type": [
            "string",
            "null"
          ],
          "enum": [
            "OD",
            "BD",
            "QDS",
            "TDS",
            null
          ]
        },
        "duration_in_days": {
          "type": [
            "integer",
            "null"
          ]
        },
        "teleconsultation_id": {
          "$ref": "#/definitions/nullable_uuid"
        }
      },
      "required": [
        "id",
        "created_at",
        "updated_at",
        "name",
        "is_protocol_drug",
        "is_deleted",
        "patient_id",
        "facility_id"
      ]
    },
    "prescription_drugs": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/prescription_drug"
      }
    },
    "user": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "full_name": {
          "$ref": "#/definitions/non_empty_string"
        },
        "sync_approval_status": {
          "type": [
            "string",
            "null"
          ]
        },
        "sync_approval_status_reason": {
          "type": [
            "string",
            "null"
          ]
        },
        "phone_number": {
          "$ref": "#/definitions/non_empty_string"
        },
        "password_digest": {
          "$ref": "#/definitions/bcrypt_password"
        },
        "registration_facility_id": {
          "$ref": "#/definitions/uuid"
        }
      },
      "required": [
        "id",
        "created_at",
        "updated_at",
        "full_name",
        "phone_number",
        "password_digest",
        "registration_facility_id"
      ]
    },
    "users": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/user"
      }
    },
    "login_user": {
      "type": "object",
      "properties": {
        "phone_number": {
          "$ref": "#/definitions/non_empty_string"
        },
        "password": {
          "$ref": "#/definitions/non_empty_string"
        },
        "otp": {
          "$ref": "#/definitions/non_empty_string"
        }
      },
      "required": [
        "phone_number",
        "password",
        "otp"
      ]
    },
    "communication": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "appointment_id": {
          "$ref": "#/definitions/uuid"
        },
        "user_id": {
          "$ref": "#/definitions/uuid"
        },
        "communication_type": {
          "type": "string",
          "enum": [
            "voip_call",
            "manual_call",
            "sms",
            "whatsapp",
            "missed_visit_sms_reminder",
            "missed_visit_whatsapp_reminder",
            "imo"
          ]
        },
        "communication_result": {
          "type": "string",
          "enum": [
            "unavailable",
            "unreachable",
            "successful",
            "unsuccessful",
            "in_progress",
            "unknown"
          ]
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        }
      },
      "required": [
        "id",
        "appointment_id",
        "user_id",
        "communication_type",
        "communication_result",
        "created_at",
        "updated_at"
      ]
    },
    "communications": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/communication"
      }
    },
    "appointment": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "patient_id": {
          "$ref": "#/definitions/uuid"
        },
        "facility_id": {
          "$ref": "#/definitions/uuid"
        },
        "creation_facility_id": {
          "$ref": "#/definitions/uuid"
        },
        "scheduled_date": {
          "type": "string",
          "format": "date"
        },
        "status": {
          "type": "string",
          "enum": [
            "scheduled",
            "cancelled",
            "visited"
          ]
        },
        "cancel_reason": {
          "type": [
            "null",
            "string"
          ],
          "enum": [
            "not_responding",
            "moved",
            "dead",
            "invalid_phone_number",
            "public_hospital_transfer",
            "moved_to_private",
            "other",
            null
          ]
        },
        "remind_on": {
          "type": [
            "string",
            "null"
          ],
          "format": "date"
        },
        "agreed_to_visit": {
          "type": [
            "boolean",
            "null"
          ]
        },
        "appointment_type": {
          "type": "string",
          "enum": [
            "manual",
            "automatic"
          ]
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        }
      },
      "required": [
        "id",
        "patient_id",
        "facility_id",
        "scheduled_date",
        "status",
        "created_at",
        "updated_at",
        "appointment_type"
      ]
    },
    "appointments": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/appointment"
      }
    },
    "medical_history": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "patient_id": {
          "$ref": "#/definitions/uuid"
        },
        "prior_heart_attack": {
          "type": "string",
          "enum": [
            "yes",
            "no",
            "unknown"
          ]
        },
        "prior_stroke": {
          "type": "string",
          "enum": [
            "yes",
            "no",
            "unknown"
          ]
        },
        "chronic_kidney_disease": {
          "type": "string",
          "enum": [
            "yes",
            "no",
            "unknown"
          ]
        },
        "receiving_treatment_for_hypertension": {
          "type": "string",
          "enum": [
            "yes",
            "no",
            "unknown"
          ]
        },
        "receiving_treatment_for_diabetes": {
          "type": "string",
          "enum": [
            "yes",
            "no",
            "unknown"
          ]
        },
        "diabetes": {
          "type": "string",
          "enum": [
            "yes",
            "no",
            "unknown"
          ]
        },
        "hypertension": {
          "type": "string",
          "enum": [
            "yes",
            "no",
            "unknown"
          ]
        },
        "diagnosed_with_hypertension": {
          "type": "string",
          "enum": [
            "yes",
            "no",
            "unknown"
          ]
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        }
      },
      "required": [
        "id",
        "patient_id",
        "prior_heart_attack",
        "prior_stroke",
        "chronic_kidney_disease",
        "receiving_treatment_for_hypertension",
        "diabetes",
        "diagnosed_with_hypertension",
        "created_at",
        "updated_at"
      ]
    },
    "medical_histories": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/medical_history"
      }
    },
    "patient_business_identifier": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "identifier": {
          "type": [
            "string",
            "null"
          ]
        },
        "identifier_type": {
          "type": "string",
          "enum": [
            "simple_bp_passport",
            "bangladesh_national_id",
            "sri_lanka_national_id",
            "sri_lanka_personal_health_number",
            "ethiopia_medical_record",
            "india_national_health_id"
          ]
        },
        "metadata_version": {
          "type": "string"
        },
        "metadata": {
          "type": "string"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        }
      },
      "required": [
        "id",
        "created_at",
        "updated_at",
        "identifier",
        "identifier_type"
      ]
    },
    "patient_business_identifiers": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/patient_business_identifier"
      }
    },
    "blood_sugar": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/uuid"
        },
        "blood_sugar_type": {
          "type": "string",
          "enum": [
            "random",
            "post_prandial",
            "fasting"
          ]
        },
        "blood_sugar_value": {
          "type": "integer"
        },
        "deleted_at": {
          "$ref": "#/definitions/nullable_timestamp"
        },
        "created_at": {
          "$ref": "#/definitions/timestamp"
        },
        "updated_at": {
          "$ref": "#/definitions/timestamp"
        },
        "recorded_at": {
          "$ref": "#/definitions/timestamp"
        },
        "patient_id": {
          "$ref": "#/definitions/uuid"
        },
        "facility_id": {
          "$ref": "#/definitions/uuid"
        },
        "user_id": {
          "$ref": "#/definitions/uuid"
        }
      },
      "required": [
        "id",
        "blood_sugar_type",
        "blood_sugar_value",
        "created_at",
        "updated_at",
        "patient_id",
        "facility_id",
        "user_id"
      ]
    },
    "blood_sugars": {
      "type": [
        "null",
        "array"
      ],
      "items": {
        "$ref": "#/definitions/blood_sugar"
      }
    }
  },
  "securityDefinitions": {
    "access_token": {
      "type": "http",
      "scheme": "bearer"
    },
    "user_id": {
      "type": "apiKey",
      "in": "header",
      "name": "X-USER-ID"
    },
    "facility_id": {
      "type": "apiKey",
      "in": "header",
      "name": "X-FACILITY-ID"
    },
    "patient_id": {
      "type": "apiKey",
      "in": "header",
      "name": "X-PATIENT-ID"
    }
  }
}